/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use client";"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const T=require("react"),c=require("prop-types"),v=require("@progress/kendo-date-math"),r=require("@progress/kendo-react-common"),S=require("@progress/kendo-react-intl"),b=require("../virtualization/Virtualization.js"),u=require("./models/TimePart.js"),x=require("./services/DayPeriodService.js"),y=require("./services/DOMService.js"),I=require("./services/HoursService.js"),M=require("./services/MinutesService.js"),H=require("./services/SecondsService.js"),d=require("../utils.js");function D(n){const s=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const t in n)if(t!=="default"){const e=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(s,t,e.get?e:{enumerable:!0,get:()=>n[t]})}}return s.default=n,Object.freeze(s)}const l=D(T),E=2,g=.05,P=100,R=0,O=9,_={[r.Keys.end]:(n,s)=>n[n.length-1],[r.Keys.home]:(n,s)=>n[0],[r.Keys.up]:(n,s)=>n[s-1],[r.Keys.down]:(n,s)=>n[s+1]},m={[u.TIME_PART.dayperiod]:x.DayPeriodService,[u.TIME_PART.hour]:I.HoursService,[u.TIME_PART.minute]:M.MinutesService,[u.TIME_PART.second]:H.SecondsService},a=class a extends l.Component{constructor(s){super(s),this.intl=null,this._element=null,this.service=null,this.virtualization=null,this.topOffset=0,this.bottomOffset=0,this.itemHeight=0,this.listHeight=0,this.topThreshold=0,this.bottomThreshold=0,this.animateToIndex=!1,this.focus=t=>{Promise.resolve().then(()=>{this.element&&this.element.focus(t)})},this.itemOffset=t=>{if(!this.virtualization||!this.service)return-1;const e=this.service.selectedIndex(this.props.value),i=this.virtualization.activeIndex(),o=this.virtualization.itemOffset(i),h=Math.abs(Math.ceil(t)-o);if(e===i&&h<E)return o;const f=e>i;return f&&h>=this.bottomThreshold||!f&&h>this.topThreshold?this.virtualization.itemOffset(i+1):o},this.calculateHeights=()=>{this.dom.didCalculate&&(this.itemHeight=this.dom.itemHeight,this.listHeight=this.dom.timeListHeight,this.topOffset=(this.listHeight-this.itemHeight)/2,this.bottomOffset=this.listHeight-this.itemHeight,this.props.mobileMode&&(this.topOffset+=O,this.bottomOffset+=O*2),this.topThreshold=this.itemHeight*g,this.bottomThreshold=this.itemHeight*(1-g))},this.configureServices=({min:t,max:e,value:i}=this.props)=>{if(this.service){const[o,h]=this.service.limitRange(t||this.min,e||this.max,i||this.props.value);this.service.configure(this.serviceSettings({min:o,max:h}))}},this.serviceSettings=t=>{const e={boundRange:this.props.boundRange||a.defaultProps.boundRange,insertUndividedMax:!1,min:v.cloneDate(this.min),max:v.cloneDate(this.max),part:this.props.part,step:this.step},i=Object.assign({},e,t);return i.boundRange=i.part.type!=="hour"||this.props.boundRange||a.defaultProps.boundRange,i},this.handleScrollAction=({target:t,animationInProgress:e})=>{if(!(!this.virtualization||!this.service)&&t&&!e){this.animateToIndex=!1;const i=this.virtualization.itemIndex(this.itemOffset(t.scrollTop)),o=this.service.data(this.props.value)[i];this.handleChange(o)}},this.handleFocus=t=>{const{onFocus:e}=this.props;e&&e.call(void 0,t)},this.handleBlur=t=>{const{onBlur:e}=this.props;e&&e.call(void 0,t)},this.handleMouseOver=()=>{if(!this._element)return;const t=r.getActiveElement(document);document&&t!==this._element&&this.props.show&&this._element.focus({preventScroll:!0})},this.handleKeyDown=t=>{if(!this.service)return;const{keyCode:e}=t;(e===r.Keys.down||e===r.Keys.up||e===r.Keys.end||e===r.Keys.home)&&t.preventDefault();const o=(_[t.keyCode]||r.noop)(this.service.data(this.props.value),this.service.selectedIndex(this.props.value));o&&this.handleChange(o)},this.handleChange=d.debounce(t=>{if(!this.service)return;const e=this.service.apply(this.props.value,t.value);if(this.props.value.getTime()===e.getTime())return;const{onChange:i}=this.props;i&&i.call(void 0,e)},P),this.dom=new y.DOMService}get element(){return this._element}get animate(){return!!(this.props.smoothScroll&&this.animateToIndex)}get min(){return this.props.min||a.defaultProps.min}get max(){return this.props.max||a.defaultProps.max}get step(){return this.props.step!==void 0&&this.props.step!==0?Math.floor(this.props.step):a.defaultProps.step}componentDidMount(){Promise.resolve().then(()=>{this._element&&(this.dom.calculateHeights(this._element),this.forceUpdate())})}componentDidUpdate(){if(!this.virtualization||!this.service)return;const s=this.service.selectedIndex(this.props.value);this.virtualization[this.animate?"animateToIndex":"scrollToIndex"](s),this.animateToIndex=!0}render(){if(!this.props.part.type||!m[this.props.part.type])return;this.calculateHeights(),this.intl=S.provideIntlService(this),this.service=new m[this.props.part.type](this.intl),this.configureServices();const s=this.service.data(this.props.value),t="translateY("+this.topOffset+"px)",e=this.service.total(this.props.value),i=l.createElement("ul",{style:{transform:t,msTransform:t},className:"k-reset"},s.map((o,h)=>l.createElement("li",{key:h,className:"k-item",onClick:()=>{this.handleChange(o)}},l.createElement("span",null,o.text))));return l.createElement("div",{className:"k-time-list",id:String(this.props.id||""),tabIndex:this.props.disabled?-1:0,ref:o=>{this._element=o},onKeyDown:this.handleKeyDown,onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseOver:this.handleMouseOver},this.dom.didCalculate?l.createElement(b.Virtualization,{bottomOffset:this.bottomOffset,children:i,className:"k-time-container",itemHeight:this.itemHeight,maxScrollDifference:this.listHeight,onScrollAction:this.handleScrollAction,ref:o=>{this.virtualization=o},role:"presentation",skip:R,tabIndex:-1,take:e,topOffset:this.topOffset,total:e}):l.createElement("div",{className:"k-time-container"},i))}};a.propTypes={id:c.number,max:c.instanceOf(Date),min:c.instanceOf(Date),part:function(s,t,e){const i=s[t];if(!i||!m[i.type])throw new Error(`
                    Invalid prop '${t}' supplied to ${e}.
                    Supported part types are hour|minute|second|dayperiod.
                `);return null},step:function(s,t,e){const i=s[t];if(i!==void 0&&i<=0)throw new Error(`
                    Invalid prop '${t}' supplied to ${e}.
                    ${t} cannot be less than 1.
                `);return null},value:c.instanceOf(Date),smoothScroll:c.bool,show:c.bool},a.defaultProps={boundRange:!1,max:d.MAX_TIME,min:d.MIDNIGHT_DATE,step:1,smoothScroll:!0};let p=a;S.registerForIntl(p);exports.TimeList=p;
